name: gcc
version: 4.9.2
dependencies:
  - binutils
  - mpfr
  - gmp
  - mpc
download: ftp://ftp.gnu.org/gnu/{{ name }}/{{ name }}-{{ version }}/{{ name }}-{{ version }}.tar.bz2
pass1:
  - cd {{ name }}-{{ version }}
  - ln -sf /tools/mpfr /tools/gmp /tools/mpc .
  - ../fix_pass1_paths.sh
  - patch -p0 < ../fix_stack_protection_detection_for_glibc.patch
  - mkdir -v ../gcc-build
  - cd ../gcc-build
  - >
    ../gcc-{{ version }}/configure --target={{ target }}
    --prefix=/tools
    --with-sysroot={{ pass1_dir }}
    --with-newlib
    --without-headers
    --with-local-prefix=/tools
    --with-native-system-header-dir=/tools/include
    --disable-nls
    --disable-shared
    --disable-multilib
    --disable-decimal-float
    --disable-threads
    --disable-libatomic
    --disable-libgomp
    --disable-libitm
    --disable-libquadmath
    --disable-libsanitizer
    --disable-libssp
    --disable-libvtv
    --disable-libcilkrts
    --disable-libstdc++-v3
    --enable-languages=c,c++ 
  - make
  - make install
